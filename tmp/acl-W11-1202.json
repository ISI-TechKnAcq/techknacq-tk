{
  "info": {
    "authors": [
      "Kevin Knight",
      "Beáta Megyesi",
      "Christiane Schaefer"
    ],
    "book": "Proceedings of the 4th Workshop on Building and Using Comparable Corpora: Comparable Corpora and the Web",
    "id": "acl-W11-1202",
    "title": "The Copiale Cipher",
    "url": "https://aclweb.org/anthology/W11-1202",
    "year": 2011
  },
  "references": [
    "acl-P06-2065"
  ],
  "sections": [
    {
      "text": [
        "The Copiale Cipher*",
        "Kevin Knight Beäta Megyesi and Christiane Schaefer",
        "USC Information Sciences Institute Department of Linguistics and Philology",
        "4676 Admiralty Way Uppsala University",
        "Marina del Rey, CA, 90292, USA Box 635, S-751 26 Uppsala, Sweden",
        "knight@isi.edu beata.megyesi@lingfil.uu.se",
        "christiane.schaefer@lingfil.uu.se",
        "SDL Language Weaver, Inc.",
        "6060 Center Drive, Suite 150 Los Angeles, CA 90045",
        "The Copiale cipher is a 105-page enciphered book dated 1866.",
        "We describe the features of the book and the method by which we deciphered it."
      ]
    },
    {
      "heading": "1.. Features of the Text",
      "text": [
        "Figure 1 shows a portion of an enciphered book from the East Berlin Academy.",
        "The book has the following features:",
        "• It is 105 pages long, containing about 75,000 handwritten characters.",
        "• The handwriting is extremely neat.",
        "• Some characters are Roman letters (such as a and b), while others are abstract symbols (such as è and <).",
        "Roman letters appear in both uppercase and lowercase forms.",
        "• Lines of text are both left-and right-justified.",
        "• There are only a few author corrections.",
        "• There is no word spacing.",
        "There are no illustrations or chapter breaks, but the text has formatting:",
        "• Paragraphs are indented.",
        "• Some lines are centered.",
        "*This material was presented as part of an invited talk at the 4th Workshop on Building and Using Comparable Corpora (BUCC 2011).",
        "• Some sections of text contain a doublequote mark (\") before each line.",
        "• Some lines end with full stop (.)",
        "or colon (:).",
        "The colon (:) is also a frequent word-internal cipher letter.",
        "• Paragraphs and section titles always begin with Roman letters (in capitalized form).",
        "The only non-enciphered inscriptions in the book are \"Philipp 1866\" and \"Copiales 3\", the latter of which we used to name the cipher.",
        "The book also contains preview fragments (\"catchwords\") at the bottom of left-hand pages.",
        "Each catchword is a copy of the first few letters from the following (right-hand) page.",
        "For example, in Figure 1, the short sequence jâa floats at the bottom of the left page, and the next page begins aaAomi...",
        "In early printing, catchwords were used to help printers validate the folding and stacking of pages."
      ]
    },
    {
      "heading": "2.. Transcription",
      "text": [
        "To get a machine-readable version of the text, we devised the transcription scheme in Figure 2.",
        "According to this scheme, the line is typed as:",
        "rïïfeimöi j: ûx^jimzj*£^",
        "The transcription uses easy-to-reach keyboard characters, so a transcriber can work without taking his/her eyes off the original document.",
        "There are approximately 90 cipher letters, including 26 unaccented Roman letters, a-z.",
        "The letters c, h, m, n, p, r, s, and x have dotted forms (e.g., C), while the letter i also has an un-dotted form.",
        "The letters m, n, r, and u have underlined variants (e.g., b), and the vowels have circumflexed variants (e.g., a).",
        "The plain letter y does not appear unaccented until page 30, but it appears quite frequently with an umlaut (y).The four Roman letters d, g, n, and z appear in both plain (d, g, n, z) and fancy forms (L, k, Y, J).",
        "Capitalized Roman letters are used to start paragraphs.",
        "We transcribe these with A-Z, though we down-case them before counting frequencies (Section 3).",
        "Down-casing D, G, N, and Z is not trivial, due to the presence of both plain and fancy lowercase forms.",
        "The non-Roman characters are an eclectic mix of symbols, including some Greek letters.",
        "Eight symbols are rendered larger than others in the text: 9, @, #, %, 2, *, ±, and n.",
        "We transcribed a total of 16 pages (10,840 letters).",
        "We carried out our analysis on those pages, after stripping catchwords and down-casing all Roman letters."
      ]
    },
    {
      "heading": "3.. Letter Frequencies and Contexts",
      "text": [
        "Figure 3 shows cipher letter frequencies.",
        "The distribution is far from flat, the most frequent letter being A (occurring 412 times).",
        "Here are the most common cipher digraphs (letter pairs) and trigraphs, with frequencies:",
        "Figure 2.",
        "Transcription scheme.",
        "Columns alternate between the cipher letters and their transcriptions.",
        "The full digraph counts reveal interesting patterns among groups of letters.",
        "For example, letters with circumflexes (â, E, I, O, U) have behaviors in common: all five tend to be preceded by z and >, and all five tend to be followed by 3 and j.",
        "To get a better handle on letter similarities, we automatically clustered the cipher letters based on their contexts.",
        "The result is shown in Figure 4.",
        "We did the clustering as follows.",
        "For each distinct letter x, we created a co-occurrence vector of length 90, to capture the distribution of letters than precede x.",
        "For example, if x is preceded 12 times by >, 0 times by U, 4 times by y, 1 time by 6, etc, then its vector looks like this: [12, 0, 4, 1, ...].",
        "For the same letter x, we created another vector that captures the distribution of letters than follow x, e.g., [0, 0, 7, 2, ...].",
        "Then we concatenated the two vectors to create v(x) = [12, 0, 4, 1, 0, 0, 7, 2, ...].",
        "We deemed two letters a and b to be similar if the cosine distance between v(a) and v(b) is small, indicating that they appear in similar contexts.",
        "We used the Scipy software (http://users.soe.ucsc.edu/~eads/cluster.html) to perform and plot a clustering that incrementally merges similar letters (and groups of letters) in a bottom-up fashion.",
        "a",
        "a",
        "A",
        "A",
        "ah",
        "6",
        "del",
        "b",
        "<",
        "tri",
        "c",
        "c",
        "C",
        "c.",
        "gam",
        "d",
        "d",
        "iot",
        "e",
        "e",
        "A",
        "E",
        "eh",
        "A",
        "lam",
        "f",
        "f",
        ">",
        "pi",
        "g",
        "arr",
        "h",
        "h",
        "H",
        "h.",
        "-",
        "hd",
        "?",
        "bas",
        "i",
        "i",
        "A I",
        "ih",
        "car",
        "j",
        "j",
        "+",
        "plus",
        "X",
        "k",
        "T",
        "cross",
        "l",
        "l",
        "?",
        "fem",
        "m",
        "m",
        "M",
        "m.",
        "B",
        "mu",
        "ê",
        "mal",
        "n",
        "n",
        "N",
        "n.",
        "D",
        "nu",
        "\\",
        "ft",
        "o",
        "o",
        "O",
        "oh",
        "o.",
        "no",
        "P",
        "P",
        "p.",
        "P",
        "sqp",
        "q",
        "q",
        "zzz",
        "r",
        "R",
        "r.",
        "F",
        "ru",
        "pipe",
        "s",
        "s",
        "S",
        "s.",
        "longs",
        "t",
        "t",
        "fi",
        "grr",
        "u",
        "u",
        "U",
        "uh",
        "U",
        "uu",
        "]",
        "grl",
        "v",
        "v",
        "i",
        "grc",
        "w",
        "w",
        "#",
        "tri..",
        "hk",
        "x",
        "x",
        "X",
        "x.",
        "2",
        "lip",
        "r",
        "sqi",
        "(",
        "y",
        "y",
        "y..",
        "9",
        "nee",
        "z",
        "z",
        "0",
        "o..",
        "•",
        "L",
        "ds",
        "ni",
        "*",
        "star",
        "K",
        "gs",
        "ki",
        "bigx",
        "I",
        "bar",
        "J",
        "zs",
        "smil",
        "n",
        "gat",
        "3",
        "three",
        "Y",
        "ns",
        "0",
        "smir",
        "toe",
        "8",
        "inf",
        "UIOUIOUIOUIOUI",
        "oooooooooo -1 – 1 – 1 – 1 – 1 – 1 – 1 – 1 – 1 – 1",
        "> z",
        ": ;",
        "+ o>",
        "II",
        "> -»•",
        "3- : e>",
        "•x- : ?",
        "«p",
        "3-n",
        "P>",
        "V \\",
        "B",
        "-aL",
        "* \"",
        "3 0*",
        "°'",
        "e",
        "!",
        "r",
        "=a ac-»-a-",
        "8 : >•",
        "-?",
        "e :",
        "S",
        "©",
        "*» :",
        "* .",
        "■",
        "m",
        "u",
        "^™",
        "^m",
        "^™",
        "Illlllllllllllllllllllll............",
        "i",
        "■",
        "The cluster diagram confirms that circumflexed letters (â, E, I, O, U) behave similarly.",
        "It also shows that the unaccented Roman letters form a natural grouping, as do underlined letters.",
        "Merges that happen low in the cluster map indicate very high similarity, e.g., the group (y, i, Y)."
      ]
    },
    {
      "heading": "4.. First Decipherment Approach",
      "text": [
        "Building on the self-similarity of Roman letters, our first theory was that the Roman letters carry all the information in the cipher, and that all other symbols are NULLs (meaningless tokens added after encipherment to confuse cryptanalysis).",
        "If we remove all other symbols, the remaining Roman letters indeed follow a typical natural language distribution, with the most popular letter occurring 12% of the time, and the least popular letters occurring rarely.",
        "The revealed sequence of Roman letters is itself nonsensical, so we posited a simple substitution cipher.",
        "We carried out automatic computer attacks against the revealed Romanletter sequence, first assuming German source, then English, then Latin, then forty other candidate European and non-European languages.",
        "The attack method is given in [Knight et al., 2006].",
        "That method automatically combines plaintext-language identification with decipherment.",
        "Unfortunately, this failed, as no language identified itself as a more likely plaintext candidate than the others.",
        "We then gave up our theory regarding NULLs and posited a homophonic cipher, with each plaintext letter being encipherable by any of several distinct cipher letters.",
        "While a well-executed homophonic cipher will employ a flat letter frequency distribution, to confound analysis, we guessed that the Copiale cipher is not optimized in this regard.",
        "We confirmed that our computer attack does in fact work on a synthetic homophonic cipher, i.e., it correctly identifies the plaintext language, and yields a reasonable, if imperfect, decipherment.",
        "We then loosed the same attack on the Copiale cipher.",
        "Unfortunately, all resulting decipherments were nonsense, though there was a very slight numerical preference for German as a candidate plaintext language."
      ]
    },
    {
      "heading": "5.. Second Decipherment Approach",
      "text": [
        "We next decided to focus on German as the most likely plaintext language, for three reasons:",
        "• the book is located in Germany",
        "• the computer homophonic attack gave a very slight preference to German",
        "• the book ends with the inscription \"Philipp 1866\", using the German double-p spelling.",
        "Pursuing the homophonic theory, our thought was that all five circumflexed letters (â, E, I, O, U), behaving similarly, might represent the same German letter.",
        "But which German letter?",
        "Since the circumflexed letters are preceded by z and >, the circumflexed letters would correspond to the German letter that often follows whatever z and > stand for.",
        "But what do they, in turn, stand for?",
        "From German text, we built a digraph frequency table, whose the most striking characteristic is that C is almost always followed by H. The German CH pair is similar to the English QU pair, but C is fairly frequent in German.",
        "A similar digraph table for the cipher letters shows that ?",
        "is almost always followed by – .",
        "So we posited our first two substitutions: ?=C and – =H.",
        "We then looked for what typically precedes and follows CH in German, and what typically precedes and follows ? – in the cipher.",
        "For example, ? – A is the most frequent cipher trigraph, while CHT is a common German trigraph.",
        "We thus hypothesized the further substitution A=T, and this led to a cascade of others.",
        "We retracted any hypothesis that resulted in poor German digraphs and trigraphs, and in this way, we could make steady progress (Figure 5).",
        "The cluster map in Figure 4 was of great help.",
        "For example, once we established a substitution like y=I, we could immediately add Y=I and i=I, because the three cipher letters behave so similarly.",
        "In this way, we mapped all circumflexed letters (â, E, I, O, U) to plaintext E. These leaps were frequently correct, and we soon had substitutions for over 50 cipher letters.",
        "Despite progress, some very frequent German trigraphs like SCH were still drastically under-represented in our decipherment.",
        "Also, many cipher letters (including all unaccented Roman letters) still lacked substitution values.",
        "A fragment of the decipherment thus far looked like this (where \"?\"",
        "stands for an as-yet-unmapped cipher letter):",
        "?GEHEIMER?UNTERLIST?VOR?DIE?GESELLE ?ERDER?TITUL ?CEREMONIE?DER?AUFNAHME",
        "On the last line, we recognized the two words CEREMONIE and DER separated by a cipher letter.",
        "It became clear that the unaccented Roman letters serve as spaces in the cipher.",
        "Note that this is the opposite of our first decipherment approach (Section 4).",
        "The nonRoman letters are not NULLs -- they carry virtually all the information.",
        "This also explains why paragraphs start with capitalized Roman letters, which look nice, but are meaningless.",
        "We next put our hypothesized decipherment into an automatic German-to-English translator (www.freetranslation.com), where we observed that many plaintext words were still untranslatable.",
        "For example, ABSCHNITL was not recognized as a translatable German word.",
        "The final cipher letter for this word is colon (:), which we had mapped previously to L. By replacing the final L in ABSCHNITL with various letters of the alphabet (A-Z), we hit on the recognized word",
        "Figure 5.",
        "Progress of decipherment.",
        "The main grid shows plaintext (German) letters across the top and ciphertext letters down the left side.",
        "The ciphertext letters are grouped into clusters.",
        "To the right of the main grid are frequent German trigraphs (der, und, ein, ...) and frequent cipher trigraphs (? – a, C:u, HC|, ...), with the two columns being separated by hypothesized trigraph decipherments.",
        "ABSCHNITT (translated as \"section\").",
        "We then realized that the function of colon (:) is to double the previous consonant (whether it be T, L, F, or some other letter).",
        "Old German writing uses a stroke with the same function.",
        "The cipher letter f was still unknown, appearing in partially deciphered words like",
        "TAFLNER, TNUPFTUCHS, and GESELLTAFLT.",
        "We tried substituting each of the letters A-Z for f, but this did not yield valid German.",
        "However, we found GESELLSCHAFLT in a German dictionary, so we concluded that f stands for SCH.",
        "This opened the door for other multi-plaintext-letter substitutions.",
        "Finally, we brought full native-German expertise to bear, by taking hypothesized decipherments (hyp) and correcting them (corr):",
        "hyp: is mache ebenfals wilhuhrlise bewegunge corr: ich mache ebenfals wilkührliche bewegungen hyp: dos mit der andern hand corr: doch mit der andern hand rzjYA:Î9|euyûîjjBY+:ACAÔpNc5p+iAf>UKzH=+Uc hyp: dritlens einer n mlt tobach mit de daume corr: drittens einer ?",
        "???",
        "tobach mit dem daumen \"B>lzut+iA:OCrucry9XZ3szfiRkCiE?5uL – NazC hyp: und de mitlelde finger der linche hand corr: und dem mittelsten finger der linchen hand pUj] – RÊs+iAK>\\jLCYû?5ul – HE>mzfiyEK hyp: beruhre mit der linche hand dein corr: berühre mit der linchen hand dein",
        "This allowed us to virtually complete our table of substitutions (Figure 6).",
        "Three cipher letters remained ambiguous:",
        "• [ could represent either SS or S",
        "• 5 could represent either H or K",
        "• U could represent either EN or EM However, these three symbols are ambiguous only with respect to deciphering into modern German, not into old German, which used different spelling conventions.",
        "The only remaining undeciphered symbols were the large ones: 9, 0, #, %, 2, *, ±, and n. These appear to be logograms, standing for the names of (doubly secret) people and organizations, as we see in this section: \"the 9 asks him whether he desires to be 2\"."
      ]
    },
    {
      "heading": "6.. Contents",
      "text": [
        "The book describes the initiation of \"DER CANDIDAT\" into a secret society, some functions of which are encoded with logograms.",
        "Appendix A contains our decipherment of the beginning of the manuscript."
      ]
    },
    {
      "heading": "7.. Conclusion",
      "text": [
        "We described the Copiale cipher and its decipherment.",
        "It remains to transcribe the rest of the manuscript and to do a careful translation.",
        "The document may contain further encoded information, and given the amount of work it represents, we believe there may be other documents using the same or similar schemes.",
        "Figure 6.",
        "Letter substitutions resulting from decipherment.",
        "Asterisks (*) indicate ambiguous cipher letters that appear twice in the chart.",
        "This table does not include the large characters: 9, 0, #, %, 2, *, ±, and n.",
        "Plaintext (German)",
        "Ciphertext",
        "A",
        "P N H ?",
        "*",
        "Ä",
        "B",
        "p",
        "C",
        "D",
        "> z",
        "E",
        "A E i O U ) z",
        "F",
        "r",
        "G",
        "6 X",
        "H",
        " – 5*",
        "I",
        "y Y",
        "J",
        "K",
        "5*",
        "L",
        "C",
        "M",
        "+",
        "N",
        "B F D 9",
        "O",
        "< ö",
        "Ö",
        "B",
        "P",
        "d",
        "R",
        "R 3 j",
        "S",
        "I i*",
        "T",
        "A",
        "U",
        "Ü",
        "V",
        "ê",
        "W",
        "M",
        "X",
        "f",
        "Y",
        "8",
        "Z",
        "S",
        "SCH",
        "T",
        "SS",
        "i*",
        "ST",
        "r",
        "CH",
        "t",
        "repeat previous",
        ":",
        "consonant",
        "EN / EM",
        "U",
        "space",
        "a C c L e f \\ k h i X l m n o p q r s / t u V W x ( J"
      ]
    },
    {
      "heading": "8.. Acknowledgments",
      "text": [
        "Thanks to Jonathan Graehl for plotting the cluster map of cipher letters.",
        "This work was supported in part by NSF grant 0904684.",
        "Ciphertext:__",
        "lit:mz)|Cl n'rrCiteöphOrLp\\6U – 3äx2KS=LMEjzuli",
        "KsMÛ8AOD|o>Ê9uLè\\r<iz9\"FXUK>U3X0n|YtC=D AÊrMÔ3r :ua=Fzl< – FfiLMYâzOi|d'Fri65OyAVziÊKCU – RsEya",
        "hziYA:O9|ezYttJ*n>â30ps\"ri'3tMây6uli=D> zpj=nh\"r rzp|nè\\ipi9>Cy3 – rOC|itXA9 – \\yti6cs=C+AtuL XO|iF:ÛAV|'8n.",
        "l>O3f3ft9zy>pAlnBAM<rAfiAoe4Ar.",
        "Plaintext, as deciphered:_",
        "gesetz buchs der hocherleuchte 2 e 0 geheimer theil.",
        "erster abschnitt geheimer unterricht vor die gesellen.",
        "erster titul.",
        "ceremonien der aufnahme.",
        "wenn die sicherheit der # durch den ältern thürheter besorget und die # vom dirigirenden 9 durch aufsetzung seines huths geöffnet ist wird der candidat von dem jüngern thürhüter aus einem andern zimmer abgeholet und bey der hand ein und vor des dirigirenden 9 tisch geführet dieser frägt ihn:",
        "erstlich ob er begehre 2 zu werden zweytens denen verordnungen der 0 sich unterwerffen und ohne wiederspenstigkeit die lehrzeit ausstehen wolle.",
        "drittens die * der 0 gu verschweigen und dazu auf das verbindlichste sich anheischig zu machen gesinnet sey.",
        "der candidat antwortet ja._",
        "Initial translation:_",
        "First lawbook",
        "Secret part.",
        "First section Secret teachings for apprentices.",
        "First title.",
        "Initiation rite.",
        "If the safety of the # is guaranteed, and the # is opened by the chief 9, by putting on his hat, the candidate is fetched from another room by the younger doorman and by the hand is led in and to the",
        "table of the chief 9, who asks him: First, if he desires to become 2.",
        "Secondly, if he submits to the rules of the 0 and without rebelliousness suffer through the time of apprenticeship.",
        "Thirdly, be silent about the * of the 0 and furthermore be willing to offer himself to volunteer in the most committed way.",
        "The candidate answers yes._"
      ]
    }
  ]
}
