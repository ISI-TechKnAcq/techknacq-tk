{
  "info": {
    "authors": [
      "Sabine Deligne",
      "Yoshinori Sagisaka"
    ],
    "book": "COLING-ACL",
    "id": "acl-P98-1047",
    "title": "Learning a Syntagmatic and Paradigmatic Structure from Language Data with a Bi-Multigram Model",
    "url": "https://aclweb.org/anthology/P98-1047",
    "year": 1998
  },
  "references": [
    "acl-J92-4003"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "In this paper, we present a stochastic language modeling tool which aims at retrieving variable-length phrases (multigrams), assuming bigram dependencies between them.",
        "The phrase retrieval can be intermixed with a phrase clustering procedure, so that the language data are iteratively structured at both a paradigmatic and a syntagmatic level in a fully integrated way.",
        "Perplexity results on ATR travel arrangement data with a bi-multigram model (assuming bigram correlations between the phrases) come very close to the trigram scores with a reduced number of entries in the language model.",
        "Also the ability of the class version of the model to merge semantically related phrases into a common class is illustrated."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "There is currently an increasing interest in statistical language models, which in one way or another aim at exploiting word-dependencies spanning over a variable number of words.",
        "Though all these models commonly relax the assumption of fixed-length dependency of the conventional ngram model, they cover a wide variety of modeling assumptions and of parameter estimation frameworks.",
        "In this paper, we focus on a phrase-based approach, as opposed to a gram-based approach: sentences are structured into phrases and probabilities are assigned to phrases instead of words.",
        "Regardless of whether they are gram or phrase-based, models can be either deterministic or stochastic.",
        "In the phrase-based framework, non determinism is introduced via an ambiguity on the parse of the sentence into phrases.",
        "In practice, it means that even if phrase abc is registered as a phrase, the possibility of parsing the string as, for instance, [ab] [c] still remains.",
        "By contrast, in a deterministic approach, all co-occurences of a, b and c would be systematically interpreted as an occurence of phrase [abc].",
        "hood, leaving-one-out likelihood (Ries et al., 1996), mutual information (Suhm and Waibel, 1994), and entropy (Masataki and Sagisaka, 1996).",
        "The use of the likelihood criterion in a stochastic framework allows EM principled optimization procedures, but it is prone to overlearning.",
        "The other criteria tend to reduce the risk of overlearning, but their optimization relies on heuristic procedures (e.g. word grouping via a greedy algorithm (Matsunaga and Sagayama, 1997)) for which convergence and optimality are not theoretically guaranteed.",
        "The work reported in this paper is based on the multigram model, which is a stochastic phrase-based model, the parameters of which are estimated according to a likelihood criterion using an EM procedure.",
        "The multigram approach was introduced in (Bimbot et al., 1995), and in (Deligne and Bimbot, 1995) it was used to derive variable-length phrases under the assumption of independence of the phrases.",
        "Various ways of theoretically releasing this assumption were given in (Deligne et al., 1996).",
        "More recently, experiments with 2-word multigrams embedded in a deterministic variable ngram scheme were reported in (Siu, 1998).",
        "In section 2 of this paper, we further formulate a model with bigram (more generally W.-gram) dependencies between the phrases, by including a paradigmatic aspect which enables the clustering of variable-length phrases.",
        "It results in a stochastic class-phrase model, which can be interpolated with the stochastic phrase model, in a similar way to deterministic approaches.",
        "In section 3 and 4, the phrase and class-phrase models are evaluated in terms of perplexity values and model size."
      ]
    },
    {
      "heading": "2 Theoretical formulation of the multigrams",
      "text": []
    },
    {
      "heading": "2.1 Variable-length phrase distribution",
      "text": [
        "In the multigram framework, the assumption is made that sentences result from the concatenation of variable-length phrases, called multigrams.",
        "The likelihood of a sentence is computed by summing the likelihood values of all possible segmentations of the sentence into phrases.",
        "The likelihood computa",
        "tion for any particular segmentation into phrases depends on the model assumed to describe the dependencies between the phrases.",
        "We call bi-multigram model the model where bigram dependencies are assumed between the phrases.",
        "For instance, by limiting to 3 words the maximal length of a phrase, the bi-multigram likelihood of the string \"a b c d\" is:",
        "To present the general formalism of the model in this section, we assume 12-gram correlations between the phrases, and we note n the maximal length of a phrase (in the above example, Ti=2 and n=3).",
        "Let W denote a string of words, and {S} the set of possible segmentations on W. The likelihood of W is:",
        "and the likelihood of a segmentation S of W is:",
        "with 8(,) denoting the phrase of rank (r) in the segmentation S. The model is thus fully defined by the set of W-gram probabilities on the set {si}; of all the phrases which can be formed by combining 1, 2, ...up to n words of the vocabulary.",
        "Maximum likelihood (ML) estimates of these probabilities can be obtained by formulating the estimation problem as a ML estimation from incomplete data (Dempster et al., 1977), where the unknown data is the underlying segmentation S. Let Q(k, k+ 1) be the following auxiliary function computed with the likelihoods of iterations k and k + 1:",
        "It has been shown in (Dempster et al., 1977) that if Q(k,k +1) > Q(k,k), then ek+1)(W) > ek)(W).",
        "Therefore the reestimation equation of p(si, si, siw_i), at iteration (k + 1), can be derived by maximizing Q(k, k + 1) over the set of parameters of iteration (k + 1), under the set of constraints E,._ p(si, I si, = 1, hence:",
        "where c(sii .",
        "S) is the number of occurences of the combination of phrases si, in the segmentation S. Reestimation equation (4) can be implemented by means of a forward-backward algorithm, such as the one described for bi-multigrams (Ti = 2) in the appendix of this paper.",
        "In a decision-oriented scheme, the reestimation equation reduces to:",
        "st(k), the segmentation maximizing where ,c(k)(s 1 W), is retrieved with a Viterbi algorithm.",
        "Since each iteration improves the model in the sense of increasing the likelihood ek)(W), it eventually converges to a critical point (possibly a local maximum)."
      ]
    },
    {
      "heading": "2.2 Variable-length phrase clustering",
      "text": [
        "Recently, class-phrase based models have gained some attention (Ries et al., 1996), but usually it assumes a previous clustering of the words.",
        "Typically, each word is first assigned a word-class label \"< Ck >\", then variable-length phrases [Ck1Ck2-.Ck,] of word-class labels are retrieved, each of which leads to define a phrase-class label which can be denoted as \"< >\".",
        "But in this approach only phrases of the same length can be assigned the same phrase-class label.",
        "For instance, the phrases \"thank you for\" and \"thank you very much for\" cannot be assigned the same class label.",
        "We propose to address this limitation by directly clustering phrases instead of words.",
        "For this purpose, we assume bigram correlations between the phrases = 2), and we modify the learning procedure of section 2.1, so that each iteration consists of 2 steps:",
        "• Step 1 Phrase clustering:",
        "• Step 2 Bi-multigram reestimation:",
        "Step 1 takes a phrase distribution as an input, assigns each phrase si to a class C,7(,1), and outputs the corresponding class distribution.",
        "In our experiments, the class assignment is performed by maximizing the mutual information between adjacent phrases, following the line described in (Brown",
        "et al., 1992), with only the modification that candidates to clustering are phrases instead of words.",
        "The clustering process is initialized by assigning each phrase to its own class.",
        "The loss in average mutual information when merging 2 classes is computed for every pair of classes, and the 2 classes for which the loss is minimal are merged.",
        "After each merge, the loss values are updated and the process is repeated till the required number of classes is obtained.",
        "Step 2 consists in reestimating a phrase distribution using the bi-multigram reestimation equation (4) or (5), with the only difference that the likelihood of a parse, instead of being computed as in Eq.",
        "(2), is now computed with the class estimates, i.e. as:",
        "This is equivalent to reestimating p(k+1)(s1 I Si) from p(k)(Cq(o,) I Q310 x p(k)(si I Cq(,,)), instead of P(k)(s.iI si) as was the case in section 2.1.",
        "Overall, step 1 ensures that the class assignment based on the mutual information criterion is optimal with respect to the current estimates of the phrase distribution and step 2 ensures that the phrase distribution optimizes the likelihood computed according to (6) with the current estimates of the class distribution.",
        "The training data are thus iteratively structured in a fully integrated way, at both a paradigmatic level (step 1) and a syntagmatic level (step 2).",
        "2.3 Interpolation of stochastic class-phrase and phrase models With a class model, the probabilities of 2 phrases belonging to the same class are distinguished only according to their unigram probability.",
        "As it is unlikely that this loss of precision be compensated by the improved robustness of the estimates of the class distribution, class based models can be expected to deteriorate the likelihood of not only train but also test data, with respect to non-class based models.",
        "However, the performance of non-class models can be enhanced by interpolating their estimates with the class estimates.",
        "We first recall the way linear interpolation is performed with conventional word ngram models, and then we extend it to the case of our stochastic phrase-based approach.",
        "Usually, linear interpolation weights are computed so as to maximize the likelihood of cross evaluation data (Jelinek and Mercer, 1980).",
        "Denoting by A and (1 – A) the interpolation weights, and by p+ the interpolated estimate, it comes for a word bigram model:",
        "with A having been iteratively estimated on a cross evaluation corpus W„o„ as:",
        "where T„„, is the number of words inardsnd c(wiwi) the number of co-occurences of tchres3' ow wi and wi in Wcross • In the case of a stochastic phrase based model - where the segmentation into phrases is not known a priori - the above computation of the interpolation weights still applies, however, it has to be embedded in dynamic programming to solve the ambiguity on the segmentation:",
        "where S*(k) the most likely segmentation of Wcross given the current estimates p(:)(sj si) can be retrieved with a Viterbi algorithm, and where c(S*(k)) is the number of sequences in the segmentation S*(k).",
        "A more accurate, but computationally more involved solution would be to compute A(k+1) as the",
        "expectation of 7(.-s-j- c(sisi I c)p+(k)(3,13,) over the set of segmentations {S} on Wcross, using for this purpose a forward-backward algorithm.",
        "However in the experiments reported in section 4, we use Eq (9) only."
      ]
    },
    {
      "heading": "3 Experiments with phrase based models",
      "text": []
    },
    {
      "heading": "3.1 Protocol and database",
      "text": [
        "Evaluation protocol A motivation to learn bigram dependencies between variable length phrases is to improve the predictive capability of conventional word bigram models, while keeping the number of parameters in the model lower than in the word trigram case.",
        "The predictive capability is usually evaluated with the perplexity measure:",
        "where T is the number of words in W. The lower PP is, the more accurate the prediction of the model is.",
        "In the case of a stochastic model, there are actually 2 perplexity values PP and PP* computed respectively from Es C(W,S) and L(W,S*).",
        "The difference PP* – PP is always positive or zero, and measures the average degree of ambiguity on a parse S of W, or equivalently the loss in terms of prediction accuracy, when the sentence likelihood is approximated with the likelihood of the best parse, as is done in a speech recognizer.",
        "In section 3.2, we first evaluate the loss (PP* -PP) using the forward-backward estimation procedure, and then we study the influence of the estimation procedure itself, i.e. Eq.",
        "(4) or (5), in terms of perplexity and model size (number of distinct 2-uplets of phrases in the model).",
        "Finally, we compare these results with the ones obtained with conventional ngram models (the model size is thus the number of distinct n-uplets of words observed), using for this purpose the CMU-Cambridge toolkit (Clarkson and Rosenfeld, 1997).",
        "Training protocol Experiments are reported for phrases having at most n = 1, 2, 3 or 4 words (for n =I, bi-multigrams correspond to conventional bi-grams).",
        "The bi-multigram probabilities are initialized using the relative frequencies of all the 2-uplets of phrases observed in the training corpus, and they are reestimated with 6 iterations.",
        "The dictionaries of phrases are pruned by discarding all phrases occur-ing less than 20 times at initialization, and less than 10 times after each iteration2, except for the 1-word phrases which are kept with a number of occurrences set to 1.",
        "Besides, bi-multigram and n-gram probabilities are smoothed with the backoff smoothing technique (Katz, 1987) using Witten-Bell discounting (Witten and Bell, 1991)3.",
        "Database Experiments are run on ATR travel arrangement data (see Tab.",
        "1).",
        "This database consists of semi-spontaneous dialogues between a hotel clerk and a customer asking for travel/accomodation informations.",
        "All hesitation words and false starts were mapped to a single marker \"*uh*\"."
      ]
    },
    {
      "heading": "3.2 Results",
      "text": [
        "Ambiguity on a parse (Table 2) The difference (PP* -PP) usually remains within about 1 point of perplexity, meaning that the average ambiguity on a parse is low, so that relying on the single best parse should not decrease the accuracy of the prediction very much.",
        "Influence of the estimation procedure (Table 3) As far as perplexity values are concerned,",
        "the estimation scheme seems to have very little influence, with only a slight advantage in using the forward-backward training.",
        "On the other hand, the size of the model at the end of the training is about 30% less with the forward-backward training: approximately 40 000 versus 60 000, for a same test perplexity value.",
        "The bi-multigram results tend to indicate that the pruning heuristic used to discard phrases does not allow us to fully avoid overtrain-ing, since perplexities with n =3, 4 (i.e. dependencies possibly spanning over 6 or 8 words) are higher than with n =2 (dependencies limited to 4 words).",
        "Comparison with n-grams (Table 4) The lowest bi-multigram perplexity (43.9) is still higher than the trigram score, but it is much closer to the trigram value (40.4) than to the bigram one (56.0) 4 .",
        "The number of entries in the bi-multigram model is much less than in the trigram model (45000 versus 75000), which illustrates the ability of the model to select most relevant phrases."
      ]
    },
    {
      "heading": "4 Experiments with class-phrase based models",
      "text": []
    },
    {
      "heading": "4.1 Protocol and database",
      "text": [
        "Evaluation protocol In section 4.2, we compare class versions and interpolated versions of the bigram, trigram and bi-multigram models, in terms of perplexity values and of model size.",
        "For bigrams (resp.",
        "trigrams) of classes, the size of the model is the number of distinct 2-uplets (resp.",
        "3-uplets) of word-classes observed, plus the size of the vocabulary.",
        "For the class version of the bi-multigrams, the size of the model is the number of distinct 2 uplets of phrase-classes, plus the number of distinct phrases maintained.",
        "In section 4.3, we show samples from classes of up to 5-word phrases, to illustrate the potential benefit of clustering relatively long and variable-length phrases for issues related to language understanding.",
        "Training protocol All non-class models are the same as in section 3.",
        "The class-phrase models are trained with 5 iterations of the algorithm described in section 2.2: each iteration consists in clustering the phrases into 300 phrase-classes (step 1), and in reestimating the phrase distribution (step 2) with Eq.",
        "(4).",
        "The bigrarns and trigrams of classes are estimated based on 300 word-classes derived with the same clustering algorithm as the one used to cluster the phrases.",
        "The estimates of all the class ditribu-tions are smoothed with the backoff technique like in section 3.",
        "Linear interpolation weights between the class and non-class models are estimated based on Eq.",
        "(8) in the case of the bigram or trigram models, and on Eq.",
        "( 9) in the case of the bi-multigram model.",
        "Database The training and test data used to train and evaluate the models are the same as the ones described in Table 1.",
        "We use an additional set of 7350 sentences and 55000 word tokens to estimate the interpolation weights of the interpolated models."
      ]
    },
    {
      "heading": "4.2 Results",
      "text": [
        "The perplexity scores obtained with the non-class, class and interpolated versions of a bi-multigram model (limiting to 2 words the size of a phrase), and of the bigram and trigram models are in Table 5.",
        "Linear interpolation with the class based models allows us to improve each model's performance by about 2 points of perplexity: the Viterbi perplexity score of the interpolated bi-multigrams (43.5) remains intermediate between the bigram (54.7) and trigram (38.6) scores.",
        "However in the trigram case, the enhancement of the performance is obtained at the expense of a great increase of the number of entries in the interpolated model (139256 entries).",
        "In the bi-multigram case, the augmentation of the model size is much less (63972 entries).",
        "As a result, the interpolated bi-multigram model still has fewer entries than the word based trigram model (75511 entries), while its Viterbi perplexity score comes even closer to the word trigram score (43.5 versus 40.4).",
        "Further experiments studying the influence of the threshold values and of the number of classes still need to be performed to optimize the performances for all models."
      ]
    },
    {
      "heading": "4.3 Examples",
      "text": [
        "Clustering variable-length phrases may provide a natural way of dealing with some of the language dis-fluencies which characterize spontaneous utterances, like the insertion of hesitation words for instance.",
        "To illustrate this point, examples of phrases which were merged into a common cluster during the training of a model allowing phrases of up to n = 5 words are listed in Table 6 (the phrases containing the hesitation marker \"uh*\" are in the upper part of the table).",
        "It is often the case that phrases differing mainly because of a speaker hesitation are merged together.",
        "Table 6 also illustrates another motivation for phrase retrieval and clustering, apart from word prediction, which is to address issues related to topic identification, dialogue modeling and language understanding (Kawahara et al., 1997).",
        "Indeed, though the clustered phrases in our experiments were derived fully blindly, i.e. with no semantic/pragmatic information, intraclass phrases often display a strong semantic correlation.",
        "To make this approach effectively usable for speech understanding, constraints derived from semantic or pragmatic knowledge (like speech act tag of the utterance for instance) could be placed on the phrase clustering process."
      ]
    },
    {
      "heading": "5 Conclusion",
      "text": [
        "An algorithm to derive variable-length phrases assuming bigram dependencies between the phrases has been proposed for a language modeling task.",
        "It has been shown how a paradigmatic element could",
        "Table 6: Example of phrases assigned to a common cluster, with a model allowing up to 5-word phrases (clusters are delimited with curly brackets) be integrated within this framework, allowing to assign common labels to phrases having a different length.",
        "Experiments on a task oriented corpus have shown that structuring sentences into phrases results in large reductions in the bigram perplexity value, while still keeping the number of entries in the language model much lower than in a trigram model, especially when these models are interpolated with class based models.",
        "These results might be further improved by finding a more efficient pruning strategy, allowing the learning of even longer dependencies without over-training, and by further experimenting with the class version of the phrase-based model.",
        "Additionally, the semantic relevance of the clusters of phrases motivates the use of this approach in the areas of dialogue modeling and language understanding.",
        "In that case, semantic/pragmatic informations could be used to constrain the clustering of the phrases."
      ]
    },
    {
      "heading": "Appendix: Forward-backward algorithm for the estimation of the bi-multigram parameters",
      "text": [
        "Equation (4) can be implemented at a complexity of 0(n2T), with n the maximal length of a sequence and T the number of words in the corpus, using a forward-backward algorithm.",
        "Basically, it consists in rearranging the order of the summations of the numerator and denominator of Eq.",
        "(4): the likelihood values of all the segmentations where sequence sj occurs after sequence si, with sequence si ending at the word at rank (t) , are summed up first; and then the summation is completed by summing over t .",
        "The cumulated likelihood of all the segmentations where 5j follows si, and si ends at (t), can be directly computed as a product of a forward and of a backward variable.",
        "The forward variable represents the likelihood of the first t words, where the last words are constrained to form a sequence:",
        "The backward variable represents the conditional likelihood of the last (T – t) words, knowing that they are preceded by the sequence [tv(j_/1+1)•••w(t)); /3(t,/j) = .C(W(7:f)i) I [W(() Assuming that the likelihood of a parse is computed according to Eq.",
        "(2), then the reestimation equation (4) can be rewritten as shown in Tab.",
        "7.",
        "The variables a and f3 can be calculated according to the following recursion equations (assuming a start and an end symbol at rank t = 0 and t = T + 1):",
        "and refer respectively to the lengths of the sequences si and si, and where the Kronecker function 4(0 equals 1 if the word sequence starting at rank t is sk, and equals 0 if not.",
        "for 1 < t < T + 1, and 1 < <",
        "In the case where the likelihood of a parse is computed with the class assumption, i.e. according to (6), the term p(k)(si Isi) in the reestimation equation shown in Table 7 should be replaced by its class equivalent, i.e. by p(k)(C,1(s,) IC,700) p(k)(si I C,7(s,)).",
        "In the recursion equation of a, the term p([W((:_)/1)] [WP-1,1')/.0]) is replaced by the corresponding class bigram probability multiplied by the class conditional probability of the sequence [W((:),,+1)].",
        "A similar change affects the recursion equation of /3, with",
        "responding class bigram probability multiplied by the class conditional probability of the sequence rwo+01"
      ]
    },
    {
      "heading": "(j) References",
      "text": [
        "I.H.",
        "Witten and T.C.",
        "Bell.",
        "1991.",
        "The zero-frequency problem: estimating the probabilities of novel events in adaptative text compression.",
        "IEEE Trans.",
        "on Information Theory, 37(4):1085-1094, July."
      ]
    }
  ]
}
