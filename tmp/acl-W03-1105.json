{
  "info": {
    "authors": [
      "Sang-Bum Kim",
      "Hee-Cheol Seo",
      "Hae-Chang Rim"
    ],
    "book": "International Workshop on Information Retrieval With Asian Languages",
    "id": "acl-W03-1105",
    "title": "Poisson Naive Bayes for Text Classification With Feature Weighting",
    "url": "https://aclweb.org/anthology/W03-1105",
    "year": 2003
  },
  "references": [],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "In this paper, we investigate the use of multivariate Poisson model and feature weighting to learn naive Bayes text classifier.",
        "Our new naive Bayes text classification model assumes that a document is generated by a multivariate Poisson model while the previous works consider a document as a vector of binary term features based on the presence or absence of each term.",
        "We also explore the use of feature weighting for the naive Bayes text classification rather than feature selection, which is a quite costly process when a small number of the new training documents are continuously provided.",
        "Experimental results on the two test collections indicate that our new model with the proposed parameter estimation and the feature weighting technique leads to substantial improvements compared to the unigram language model classifiers that are known to outperform the original pure naive Bayes text classifiers."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "The naive Bayes classifier has been one of the core frameworks in the information retrieval research for many years.",
        "Recently, naive Bayes is emerged as a research topic itself because it sometimes achieves good performances on various tasks, compared to more complex learning algorithms, in spite of the wrong independence assumptions on naive Bayes.",
        "Similarly, naive Bayes is also an attractive approach in the text classification task because it is simple enough to be practically implemented even with a great number of features.",
        "This simplicity enables us to integrate the text classification and filtering modules with the existing information retrieval systems easily.",
        "It is because that the frequency related information stored in the general text retrieval systems is all the required information in naive Bayes learning.",
        "No further complex generalization processes are required unlike the other machine learning methods such as SVM or boosting.",
        "Moreover, incremental adaptation using a small number of new training documents can be performed by just adding or updating frequencies.",
        "Several earlier works have extensively studied the naive Bayes text classification (Lewis, 1992; Lewis, 1998; McCallum and Nigam, 1998).",
        "However, their pure naive Bayes classifiers considered a document as a binary feature vector, and so they can’t utilize the term frequencies in a document, resulting the poor performances.",
        "For that reason, the unigram language model classifier (or multinomial naive Bayes text classier) has been referred as an alternative and promising naive Bayes by a number of researchers(McCallum and Nigam, 1998; Du-mais et al., 1998; Yang and Liu, 1999; Nigam et al., 2000).",
        "Although the unigram language model classifiers usually outperform the pure naive Bayes, they also have given the disappointing results compared to many other statistical learning methods such as nearest neighbor classifiers(Yang and Chute, 1994), support vector machines(Joachims, 1998), and boosting(Schapire and Singer, 2000), etc.",
        "mains(Domingos and Pazzani, 1997) in spite of its wrong independent assumption.",
        "In the context of text classification, the probability of class c given a document di is calculated by Bayes’ theorem as follows:",
        "Using Equation (3), we can get the posterior probability p(cldi) by obtaining Zi,, which is a form of log ratio similar to the BIM retrieval model(Jones et al., 2000).",
        "It means that the linked independence as-sumption(Cooper et al., 1992), which explains that the strong independent assumption can be relaxed in the BIM model, is sufficient for the use of naive Bayes text classification model.",
        "With this framework, two representative naive Bayes text classification approaches are well introduced in (McCallum and Nigam, 1998).",
        "They designated the pure naive Bayes as multivariate Bernoulli model, and the unigram language model classifier as multinomial model.",
        "Instead, we introduce multivariate Poisson model to improve the pure naive Bayes text classification in the next section.",
        "In the real world, an operational text classification system is usually placed in the environment where the amount of human-annotated training documents is small in spite of the hundreds of thousands classes.",
        "Moreover, retraining of the text classifiers is required since a small number of new training documents are continuously provided.",
        "In this environment, naive Bayes is probably the most appropriate model for the practical systems rather than other complex learning models.",
        "Therefore, more intensive studies about the naive Bayes text classification model are required.",
        "In this paper, we revisit the naive Bayes framework, and propose a Poisson naive Bayes model for text classification with a statistical feature weighting method.",
        "Feature weighting has many advantages compared to the previous feature selection approaches, especially when the new training examples are continuously provided.",
        "Our new model assumes that a document is generated by a multivariate Poisson model, and their parameters are estimated by weighted averaging of the normalized and smoothed term frequencies over all the training documents.",
        "Under the assumption, we have tested the feature weighting approach with three measures: information gain, x2-statistic, and newly introduced probability ratio.",
        "With the proposed model and feature weighting techniques, we can get much better performance without losing the simplicity and efficiency of the naive Bayes model.",
        "The remainder of this paper is organized as follows.",
        "The next section presents a naive Bayes framework for the text classification briefly.",
        "Section 3 describes our new naive Bayes model and the proposed technique, and the experimental results are presented in Section 4.",
        "Finally, we conclude the paper by suggesting possible directions for future work in Section 5."
      ]
    },
    {
      "heading": "2 Naive Bayes Text Classification",
      "text": []
    },
    {
      "heading": "3 Poisson Naive Bayes Text Classification",
      "text": [
        "A naive Bayes classifier is a well-known and highly practical probabilistic classifier, and has been employed in many applications.",
        "It assumes that all attributes of the examples are independent of each other given the context of the class, that is, an independent assumption.",
        "Several studies show that naive Bayes performs surprisingly well in many do"
      ]
    },
    {
      "heading": "3.1 Overview",
      "text": [
        "The Poisson distribution is most commonly used to model the number of random occurrences of some phenomenon in a specified unit of space or time, for example, the number of phone calls received by a telephone operator in a 10-minute period.",
        "If we think that the occurrence of each term is a random occurrence in a fixed unit of space (i.e. a length of document) the Poisson distribution is intuitively suitable to model the term frequencies in a given document.",
        "For that reason, the use of Poisson model is widely investigated in the IR literature, but it is rarely used for the text classification task(Lewis, 1998).",
        "It motivates us to adopt the Poisson model for learning the naive Bayes text classification.",
        "Our model assumes that dg is generated by multivariate Poisson model.",
        "In other words, a document dg is a random vector which consists of the Poisson random variables Xi, and Xi has the value of within-term-frequency fig for the i-th term ti.",
        "Thus, if we assume the independence among the terms in dg, a probability of dg is represented by,",
        "where, A is the Poisson mean.",
        "As a result, the zgc function of Equation (2) is rewritten using Equations (4) and (5) as follows:",
        "where, Ai and µi is the Poisson mean for ti in class c and class �c, respectively.",
        "The most important issues of this work are as follows:",
        "• How to decide the frequency fig representing the characteristic of document dg?",
        "• How to estimate the model parameter Ai and µi representing the characteristic of each class?",
        "We propose the possible answers in the next subsection."
      ]
    },
    {
      "heading": "3.2 Parameter Estimation",
      "text": [
        "Since fig is a frequency of a term i in a document dg with a fixed length according to the definition of Poisson distribution, we should normalize the actual term frequencies in the documents with the different length.",
        "In addition, many earlier works in NLP and IR fields recommend that smoothing term frequencies is necessary in order to build a more accurate model.",
        "Thus, we estimate fig as the normalized and smoothed frequency of actual term frequency xig, represented by,",
        "where B is a laplace smoothing parameter, T is any huge value which makes all the �fig in our model an integer value1, and dlg is the length of dg.",
        "Conceptually, �fig can be regarded as the value estimated by the following steps : 1) Add B of all lV l terms to the document dg, 2) Scale dg up to d'g whose total length is T without changing the proportion of frequency for each term ti, 3) Count ti in d'g. Then, Poisson mean Ai, which represents an average number of occurrence of ti in the documents belonging to class c, is estimated using the normalized and smoothed �fig values over the training documents as follows:",
        "where Dc is the set of training documents belonging to class c, and g(dglc)2 is the interpolation of the uniform probability and the probability proportional to the length of the document, and the interpolation is calculated as follows:",
        "Simple averaging of �fig, the case of a=1, seems to be correct to estimate Ai.",
        "However, the statistics",
        "from the long documents can be more reliable than those in the short documents, hence we try to interpolate between the two different probabilities with the parameter a ranging from 0 to 1.",
        "Consequently, Ai is a weighted average over all training documents belonging to the class c, and �i for the class c� can be estimated in the same manner."
      ]
    },
    {
      "heading": "3.3 Feature Weighting",
      "text": [
        "Feature selection is often performed as a preprocessing step for the purpose of both reducing the feature space and improving the classification performance.",
        "Text classifiers are then trained with various machine learning algorithms in the resulting feature space.",
        "(Yang and Pedersen, 1997) investigated some measures to select useful term features including mutual information(MI), information gain(IG), and x2-statistics(CHI), etc.",
        "On the contrary, (Joachims, 1998) claimed that there is no useless term features, and it is preferable to use all term features.",
        "It is clear that learning and classification become very efficient when the feature space is considerably reduced.",
        "However, there is no definite conclusion about the contribution of feature selection to improve overall performances of the text classification systems.",
        "It may considerably depend on the employed learning algorithm.",
        "We believe that proper external feature selection or weighting is required to improve the performances of naive Bayes since the naive Bayes has no framework of the discriminative optimizing process in itself.",
        "Of the two possible approaches, feature selection is very inefficient in case that the additional training documents are provided continuously.",
        "It is because the feature set should be redefined according to the modified term statistics in the new training document set, and classifiers should be trained again with this new feature set.",
        "For that reason, we prefer to use feature weighting to improve naive Bayes rather than feature selection.",
        "With the feature weighting method, our Zic is redefined as follows:",
        "where, wic is the weight of feature for the class c, and Wc is the normalization factor, that is, EVi� wic.",
        "In our work, three measures are used to weight",
        "presence of ti absence of ti labeled as c a b not labeled as c c d each term feature: information gain, x2-statistics and probability ratio.",
        "Information gain (or average mutual information) is an information-theoretic measure defined by the amount of reduced uncertainty given a piece of information.",
        "We use the information gain value as the weight of each term for the class c, and the value is calculated using a document event model as follows:",
        "where, for example, p(c) is the number of documents belonging to the class c divided by the total number of documents, and p (�w) is the number of documents without the term w divided by the total number of documents, etc.",
        "Second measure we used is x2- statistics developed for the statistical test of the hypothesis.",
        "In the text classification, given a two-way contingency table for each term ti and class c as represented in Table 1, wic is calculated as follows:",
        "where, a,b,c and d indicate the number of documents for each cell in the above contingency table.",
        "(Yang and Pedersen, 1997) compared the various feature selection methods, and concluded that these two measures are most effective for their kNN and LLSF classification models.",
        "Finally, we introduce a new measure - probability ratio.",
        "Probability ratio is defined by,",
        "This measure calculates the sum of the ratio of two class-conditional probabilities from each class and its reciprocal.",
        "The former term and the latter term",
        "are representing the degree of predicting positive and negative class respectively.",
        "The weight using this measure always has a positive value higher than 2.",
        "We have conducted the experiments with these three measures for the feature weighting test, and the results are given in Section 4."
      ]
    },
    {
      "heading": "3.4 Implementation Issues",
      "text": [
        "By a couple of simple arithmetic operations, our final zjc function can be rewritten as follows:",
        "In this equation, \\ i' and µi' are just weighted average of T-dropped nfij, that is, xzj+0 Wc, Ac and dh+0IVI.",
        "Bc are the class-specific constants, and T is a constant over all the classes and documents.",
        "If the class c is fixed, Wc, �c and T can be dropped, and the ranking function z*jc is defined as follows:",
        "When we use this ranking function z*jc, the calculation of the exact posterior probability p (c I dj) presented in Section 2 becomes impossible.",
        "However, it is trivial since most of IR systems do not have interest on exact posterior probability.",
        "In addition, all the parameters in our model is guaranteed to be calculated by the incremental way.",
        "Our experiments were performed on the two datasets: Reuters21578 and KoreanNews2002 collection.",
        "Reuters21578 collection is the most widely used benchmark dataset for the text categorization research.",
        "We have used “ModApte” split version, which consists of 9603 training documents and 3299 test documents.",
        "There are 90 categories, and each document has one or more of the categories.",
        "We have built another benchmark collection - Ko-reanNews2002 collection.",
        "KoreanNews2002 collection is composed of 15,000 news articles published during the year of 2002.",
        "The articles are collected from a number of Korean news portal websites, and each article is labeled with exactly one of the 46 classes.",
        "All the documents have date stamps attached and have been ordered according to their date stamps.",
        "With this date order, we divided them into the former 10,000 documents for training and the latter 5,000 documents for testing.",
        "The performances are evaluated using popular F1 measure, and the F1 values for each class are micro-averaged(MicroF 1) and macro-averaged(MacroF 1) to examine the general classification performances."
      ]
    },
    {
      "heading": "4.2 Proposed Model: PNB (vs. UM)",
      "text": [
        "Figure 1 shows the performances of our new model named Poisson naive Bayes(PNB) classifiers ac",
        "cording to the interpolation parameter a for estimating Poisson mean A and µ.",
        "The baseline method is a unigram model classifier (UM) which is also referred to multinomial naive Bayes classifier described in (McCallum and Nigam, 1998).",
        "Our proposed PNB clearly outperforms the UM.",
        "Although there is no significant difference of MicroF1 values among the various a values, the F1 value of each class is considerably affected by the a values.",
        "Figure 2 presents the fluctuations of the F1 values for 4 classes in Reuters21578 collection.",
        "From this result, we can assume that there is no global optimal value of a, but each class has its own optimal a.",
        "In our experiments, many of the classes have the highest F1 value when a is about 0.8 or 0.9 except some classes such as corn class which shows the highest F1 value at a = 0.3.",
        "Similar results are obtained in the KoreanNews2002 collections.",
        "Table 2 and 3 shows the MicroF 1 and MacroF 1 values of the unigram model classifiers and our PNB on the two collections, where PNB(min) and PNB(max) are the highest and lowest values at different a.",
        "In any cases, PNB is superior to UM."
      ]
    },
    {
      "heading": "4.3 Feature Weighting: PNB-{IG,CHI,PrR}",
      "text": [
        "We have fixed the interpolation parameter a at 0.8, and evaluated the following feature weighting methods: PNB-IG with information gain, PNB-CHI with X2-statistic, and PNB-PrR with probability ratio.",
        "In these experiments, some important behaviors of feature weighted PNB classifiers are observed from the results.",
        "In order to explain the phenomenon, we have grouped the classes into the bins according to",
        "the number of training documents for each class.",
        "5 bins are generated in both Reuters21578 and KoreanNews2002 collection.",
        "The different average F1 performance of each bin is shown in Figure 3.",
        "The clear observation from this result is that feature weighting is highly effective in the bins of the classes with a small number of training documents, but hardly contributes the performances for the bins of the classes with sufficiently many training documents.",
        "In the bins with enough training documents, simple PNB classifiers show the similar performances to the PNB with feature weighting methods.",
        "This tendency is more clearly captured in the Reuters21578 collection, where a third of the classes have fewer than 10 training documents.",
        "In contrast, two thirds of the classes in the KoreanNews2002 collection have more than a hundred of training documents.",
        "Among the feature weighting methods, PNB-PrR performs stably than PNB-IG and PNB-CHI.",
        "PNB-IG or PNB-CHI somewhat degrades the performance in the classes with the large number of training documents, while PNB-PrR maintains the good performances in those classes on both of the collections.",
        "On the other hand, PNB-IG and PNB-CHI considerably improve the performances in the rare categories though the improvement is somewhat different from the two collections.",
        "For example, PNB-CHI significantly improves the simple PNB on the Reuters21578 collection while PNB-IG is very effective on the KoreanNews2002 collection.",
        "Thus, we can realize that the proper feature weighting method depends on the characteristics of the collection, and different feature weighting strategies should be adopted to improve the naive Bayes text classification.",
        "From these observations, we tested another classifier PNB* which employ different feature weighting method for each bin to obtain the near optimal performances.",
        "Table 4 and 5 show the summary of the performances including PNB* on the both collections.",
        "Our proposed model with feature weighting methods are very effective compared to the baseline UM method.",
        "Moreover, the performance of bin-optimized PNB* in Reuters21578 collection shows that Poisson naive Bayes with feature weighting methods can achieve the state-of-the-art performances achieved by SVM or kNN which are reported in (Yang and Liu, 1999; Joachims, 1998)."
      ]
    },
    {
      "heading": "5 Conclusion and Future Work",
      "text": [
        "In this paper, we propose a Poisson naive Bayes text classification model with feature weighting.",
        "Our new model uses the normalized and smoothed term frequencies for each document, and Poisson parameters are calculated by weighted averaging the frequencies over all training documents.",
        "Experimental results show that the proposed model is quite useful to build probabilistic text classification systems without requiring any extra cost compared to the traditional simple naive Bayes or unigram language model classifiers.",
        "Further improvement is achieved by a feature weighting technique.",
        "In our experiments, three measures including chi-square statistics, information gain, and newly introduced probability ratio are"
      ]
    },
    {
      "heading": "UM PNB PNB-IG PNB-CHI PNB-PrR PNB *",
      "text": [
        "MicroF1 0.6502 0.7056 0.7114 0.7122 0.7409(+13.95%) 0.7438 MacroF 1 0.5208 0.5906 0.6305(+21.06%) 0.5748 0.6119 0.6662 adopted to weigh each term feature.",
        "The results show that feature weighting considerably improves the performances for the classes with a small number of training documents, but not for the classes with the sufficient training documents.",
        "Probability ratio also performs well, especially in the classes with the great number of training documents where other feature weighting methods show the unsatisfactory performances.",
        "For the future work, we will try to develop some automatic methods of selecting proper feature weighting measures and determining the interpolation parameters for the different classes.",
        "Furthermore, we will explore applications of our approach in other tasks such as adaptive filtering and relevance feedback."
      ]
    }
  ]
}
