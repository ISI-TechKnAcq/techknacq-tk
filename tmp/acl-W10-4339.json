{
  "info": {
    "authors": [
      "Teruhisa Misu",
      "Komei Sugiura",
      "Kiyonori Ohtake",
      "Chiori Hori",
      "Hideki Kashioka",
      "Hisashi Kawai",
      "Satoshi Nakamura"
    ],
    "book": "Proceedings of the SIGDIAL 2010 Conference",
    "id": "acl-W10-4339",
    "title": "Modeling Spoken Decision Making Dialogue and Optimization of its Dialogue Strategy",
    "url": "https://aclweb.org/anthology/W10-4339",
    "year": 2010
  },
  "references": [],
  "sections": [
    {
      "text": [
        "Teruhisa Misu, Komei Sugiura, Kiyonori Ohtake, Chiori Hori, Hideki Kashioka, Hisashi Kawai and Satoshi Nakamura",
        "MASTAR Project, NICT Kyoto, Japan.",
        "teruhisa.misu@nict.go.jp",
        "This paper presents a spoken dialogue framework that helps users in making decisions.",
        "Users often do not have a definite goal or criteria for selecting from a list of alternatives.",
        "Thus the system has to bridge this knowledge gap and also provide the users with an appropriate alternative together with the reason for this recommendation through dialogue.",
        "We present a dialogue state model for such decision making dialogue.",
        "To evaluate this model, we implement a trial sightseeing guidance system and collect dialogue data.",
        "Then, we optimize the dialogue strategy based on the state model through reinforcement learning with a natural policy gradient approach using a user simulator trained on the collected dialogue corpus."
      ]
    },
    {
      "heading": "1. Introduction",
      "text": [
        "In many situations where spoken dialogue interfaces are used, information access by the user is not a goal in itself, but a means for decision making (Polifroni and Walker, 2008).",
        "For example, in a restaurant retrieval system, the user's goal may not be the extraction of price information but to make a decision on candidate restaurants based on the retrieved information.",
        "This work focuses on how to assist a user who is using the system for his/her decision making, when he/she does not have enough knowledge about the target domain.",
        "In such a situation, users are often unaware of not only what kind of information the system can provide but also their own preference or factors that they should emphasize.",
        "The system, too, has little knowledge about the user, or where his/her interests lie.",
        "Thus, the system has to bridge such gaps by sensing (potential) preferences of the user and recommend information that the user would be interested in, considering a trade-off with the length of the dialogue.",
        "We propose a model of dialogue state that considers the user's preferences as well as his/her knowledge about the domain changing through a decision making dialogue.",
        "A user simulator is trained on data collected with a trial sightseeing system.",
        "Next, we optimize the dialogue strategy of the system via reinforcement learning (RL) with a natural policy gradient approach."
      ]
    },
    {
      "heading": "2. Spoken decision making dialogue",
      "text": [
        "We assume a situation where a user selects from a given set of alternatives.",
        "This is highly likely in real world situations; for example, the situation wherein a user selects one restaurant from a list of candidates presented",
        "Choose the optimal spot"
      ]
    },
    {
      "heading": "1.. Cherry Blossoms",
      "text": [
        "/TAlternativeSN (choices)",
        "Kinkakuji-Temple",
        "by a car navigation system.",
        "In this work, we deal with a sightseeing planning task where the user determines the sightseeing spot to visit, with little prior knowledge about the target domain.",
        "The study of (Ohtake et al., 2009), which investigated human-human dialogue in such a task, reported that such consulting usually consists of a sequence of information requests from the user, presentation and elaboration of information about certain spots by the guide followed by the user's evaluation.",
        "We thus focus on these interactions.",
        "Several studies have featured decision support systems in the operations research field, and the typical method that has been employed is the Analytic Hierarchy Process (Saaty, 1980) (AHP).",
        "In AHP, the problem is modeled as a hierarchy that consists of the decision goal, the alternatives for achieving it, and the criteria for evaluating these alternatives.",
        "An example hierarchy using these criteria is shown in Figure 1.",
        "For the user, the problem of making an optimal decision can be solved by fixing a weight vector Puser = (pi ,p2,---,PM) for criteria and local weight matrix v user (vii,vi2,...,viM,---,vnm) for alternatives in terms of the criteria.",
        "The optimal alternative is then identified by selecting the spot k with the maximum priority of M=i PmVkm.",
        "In typical AHP methods, the procedure of fixing these weights is often conducted through pairwise comparisons for all the possible combinations of criteria and spots in terms of the criteria, followed by weight tuning based on the results of these comparisons (Saaty, 1980).",
        "However, this methodology cannot be directly applied to spoken dialogue systems.",
        "The information about the spot in terms of the criteria is not known to the users, but is obtained only via navigating through the system's information.",
        "In addition, spoken dialogue systems usually handle several candidates and criteria, making pairwise comparison a costly affair.",
        "We thus consider a spoken dialogue framework that estimates the weights for the user's preference (potential preferences) as well as the user's knowledge about the domain through interactions of information retrieval and navigation.",
        "2.Japanese",
        "Garden",
        "Ryoanji-",
        "Temple",
        "3.",
        "Easy",
        "Access",
        "Nanzenji-",
        "Temple"
      ]
    },
    {
      "heading": "3. Decision support system with spoken dialogue interface",
      "text": [
        "The dialogue system we built has two functions: answering users' information requests and recommending information to them.",
        "When the system is requested to explain about the spots or their determinants, it explains the sightseeing spots in terms of the requested determinant.",
        "After satisfying the user's request, the system then provides information that would be helpful in making a decision (e.g., instructing what the system can explain, recommending detailed information of the current topic that the user might be interested in, etc.).",
        "Note that the latter is optimized via RL (see Section 4).",
        "Our back-end DB consists of 15 sightseeing spots as alternatives and 10 determinants described for each spot.",
        "We select determinants that frequently appear in the dialogue corpus of (Ohtake et al., 2009) (e.g. cherry blossoms, fall foliage).",
        "The spots are annotated in terms of these determinants if they apply to them.",
        "The value of the evaluation enm is \"1\" when the spot n applies to the determinant m and \"0\" when it does not.",
        "The content of the recommendation is determined based on one of the following six methods:",
        "1.",
        "Recommendation of determinants based on the currently focused spot (Method 1)",
        "This method is structured on the basis of the user's current focus on a particular spot.",
        "Specifically, the system selects several determinants related to the current spot whose evaluation is \"1\" and presents them to the user.",
        "2.",
        "Recommendation of spots based on the currently focused determinant (Method 2)",
        "This method functions on the basis of the focus on a certain specific determinant."
      ]
    },
    {
      "heading": "3.. Open prompt (Method 3)",
      "text": [
        "The system does not make a recommendation, and presents an open prompt."
      ]
    },
    {
      "heading": "4.. Listing of determinants 1 (Method 4)",
      "text": [
        "This method lists several determinants to the user in ascending order from the low level user knowledge Ksys (that the system estimates).",
        "(Ksys, Psys, pmand Pr(pm = 1) are defined and explained in Section 4.2.)"
      ]
    },
    {
      "heading": "5.. Listing of determinants 2 (Method 5)",
      "text": [
        "This method also lists the determinants, but the order is based on the user's high preference Psys (that the system estimates)."
      ]
    },
    {
      "heading": "6.. Recommendation of user's possibly preferred spot (Method 6)",
      "text": [
        "The system recommends a spot as well as the determinants that the users would be interested in based on the estimated preference Psys.",
        "The system selects one spot k with a maximum value of",
        "T>M=i Pr(pm = 1) â€¢ ek,m.",
        "This idea is based on collaborative filtering which is often used for recommender systems (Breese et al., 1998).",
        "This method will be helpful to users if the system successfully estimates the user's preference; however, it will be irrelevant if the system does not.",
        "We will represent these recommendations through a dialogue act expression, (casys{scsys}), which consists of a communicative act casysand the semantic content scsys.",
        "(For example Methodl{(Spot5), (Det3,Det4,Det5)}, Method3{NULL, NULL}, etc.)"
      ]
    },
    {
      "heading": "4. Optimization of dialogue strategy",
      "text": [
        "We introduce a user model that consists of a tuple of knowledge vector Kuser, preference vector Puser, and local weight matrix Vuser.",
        "In this paper, for simplicity, a user's preference vector or weight for determinants Puser = (pi,p2,...,pM) is assumed to consist of binary parameters.",
        "That is, if the user is interested in (or potentially interested in) the determinant m and emphasizes it when making a decision, the preference pm is set to \"1\".",
        "Otherwise, it is set to \"0\".",
        "In order to represent a state that the user has potential preference, we introduce a knowledge parameter Kuser = (ki,k2 ,...,kM ) that shows if the user has the perception that the system is able to handle or he/she is interested in the determinants.",
        "km is set to \"1\" if the user knows (or is listed by system's recommendations) that the system can handle determinant m and \"0\" when he/she does not.",
        "For example, the state that the determinant m is the potential preference of a user (but he/she is unaware of that) is represented by (km = 0, pm = 1).",
        "This idea is in contrast to previous research which assumes some fixed goal observable by the user from the beginning of the dialogue (Schatzmann et al., 2007).",
        "A user's local weight vnm for spot n in terms of determinant m is set to \"1\", when the system lets the user know that the evaluation of spots is \"1\" through recommendation Methods 1, 2 and 6.",
        "We constructed a user simulator that is based on the statistics calculated through an experiment with the trial system (Misu et al., 2010) as well as the knowledge and preference of the user.",
        "That is, the user's communicative act and the semantic content for the system's recommendation asys are generated based on the following equation:",
        "â€¢ pr(scuser \\ K^user 7 Puser ,c",
        "user user user ,casys,scsys)",
        "This means that the user's communicative act causer is sampled based on the conditional probability of Pr(caluser\\caSys) in (Misu et al., 2010).",
        "The semantic content scuser is selected based on the user's preference Puser under current knowledge about the determinants Kuser.",
        "That is, the sc is sampled from the determinants within the user's knowledge (km = 1) based on the probability that the user requests the determinant of his/her preference/non-preference, which is also calculated from the dialogue data of the trial system.",
        "We defined the state expression of the user in the previous section.",
        "However the problem is that for the system, the state (Puser, Kuser, Vuser) is not observable, but is only estimated from the interactions with the user.",
        "Thus, this model is a partially observable Markov decision process (POMDP) problem.",
        "In order to estimate unobservable properties of a POMDP",
        "Pr(causer ,scuser \\casys,s = Pr(calser\\caSys)",
        "Priors of the estimated state:",
        "- System recommendation:",
        "- User query:",
        "aUser = Accept{(Spot5), (Det:i)} Posterior of the estimated state:",
        "and handle the problem as an MDP, we introduce the system's inferential user knowledge vector Ksys or probability distribution (estimate value) Ksys = (Pr(ki = 1),Pr(k2 = 1),...,Pr(kM = 1)) and that of preference Psys = (Pr(pi = 1),Pr(p2 = 1),...,Pr(pM = 1)).",
        "The dialogue state DSt+i or estimated user's dialogue state of the step t + 1 is assumed to be dependent only on the previous state DS , as well as the interactions P = (aSys ,atuser ).",
        "The estimated user's state is represented as a probability distribution and is updated by each interaction.",
        "This corresponds to representing the user types as a probability distribution, whereas the work of (Ko-matani et al., 2005) classifies users to several discrete user types.",
        "The estimated user's preference Psys is updated when the system observes the interaction I .",
        "The update is conducted based on the following Bayes' theorem using the previous state DS as a prior.",
        "Here, Pr(I*\\pm = 1),Pr(I*\\(pm = 0) to the right side was obtained from the dialogue corpus of (Misu et al., 2010).",
        "This posterior is then used as a prior in the next state update using interaction I + .",
        "An example of this update is illustrated in Figure 2.",
        "The reward function that we use is based on the number of agreed attributes between the user preference and the decided spot.",
        "Users are assumed to determine the spot based on their preference Puser under their knowledge Kuser (and local weight for spots Vuser) at that time, and select the spot k with the maximum priority of J2m kk â–  pk â–  vkm.",
        "The reward R is then calculated based on the improvement in the number of agreed attributes between the user's actual (potential) preferences and the decided spot k over the expected agreement by random spot selection.",
        "For example, if the decided spot satisfies three preferences and the average agreement of the agreement by random selection is 1.3, then the reward is 1.7.",
        "The problem of system recommendation generation is optimized through RL.",
        "The MDP (S, A, R) is defined as follows.",
        "The state parameter S = (si,s2,...,sI) is generated by extracting the features of the current dialogue state DS .",
        "We use the following 29 features .",
        "1.",
        "Parameters that indicate the # of interactions from the beginning of the dialogue.",
        "This is approximated by five parameters using triangular functions.",
        "2.",
        "User's previous communicative act (1 if a knowledge about determinants ( nN= Pr(kn =1)).",
        "5.",
        "Number of presented spot information.",
        "6.",
        "Expectation of the probability that the user emphasizes the determinant in the current state (Pr(kn = 1) x Pr(pn = 1) ) (10 parameters).",
        "The action set A consists of the six recommendation methods shown in subsection 3.2.",
        "Reward R is given by the reward function ofsubsection 4.3.",
        "A system action asys (casys) is sampled based on the following soft-max (Boltzmann) policy.",
        "Here, 0 = (0ii,0i2,...0iI,...,9JI) consists of J (# actions) x I (# features) parameters.",
        "The parameter 6ji works as a weight for the i-th feature of the action j and determines the likelihood that the action j is selected.",
        "This 0 is the target of optimization by RL.",
        "We adopt the Natural Actor Critic (NAC) (Peters and Schaal, 2008), which adopts a natural policy gradient method as the policy optimization method.",
        "For each simulated dialogue session, a simulated user (Puser, Kuser, Vuser) is sampled.",
        "A preference vector Puser of the user is generated so that he/she has four preferences.",
        "As a result, four parameters in Puser are \"1\" and the others are \"0\".",
        "This vector is fixed throughout the dialogue episode.",
        "This sampling is conducted based on the rate proportional to the percentage ofusers who emphasize it for making decisions (Misu et al., 2010).",
        "The user's knowledge Kuser is also set based on the statistics of the \"percentage of users who stated the determinants before system recommendation\".",
        "For each determinant, we sample a random valuable r that ranges from \"0\" to \"1\", and km is set to \"1\" if r is smaller than the percentage.",
        "All the parameters of local weights Vuser are initialized to \"0\", assuming that users have no prior knowledge about the candidate spots.",
        "As for system parameters, the estimated user's preference Psys and knowledge Ksys are initialized based on the statistics of our trial system (Misu et al., 2010).",
        "We assumed that the system does not misunderstand the user's action.",
        "Users are assumed to continue a dialogue session for 20 turns, and episodes are sampled using the policy n at that time and the user simulator wise 0).",
        "3.",
        "System's previous communicative act (1 if yj, otherwise 0).",
        "4.",
        "Sum of the estimated user",
        "Reward (Â±std)",
        "Reward (Â±std)",
        "of subsection 4.1.",
        "In each turn, the system is rewarded using the reward function of subsection 4.3.",
        "The pol-icy(parameter0) is updatedusingNACin every2,000 dialogues.",
        "The policy was fixed at about 30,000 dialogue episodes.",
        "We analyzed the learned dialogue policy by examining the value of weight parameter 0.",
        "We compared the parameters of the trained policy between actions.",
        "The weight of the parameters that represent the early stage of the dialogue was large in Methods 4 and 5.",
        "On the other hand, the weight of the parameters that represent the latter stage of the dialogue was large in Methods 2 and 6.",
        "This suggests that in the trained policy, the system first bridges the knowledge gap between the user, estimates the user's preference, and then, recommends specific information that would be useful to the user.",
        "Next, we compared the trained policy with the following baseline methods."
      ]
    },
    {
      "heading": "1.. No recommendation (B1)",
      "text": [
        "The system only provides the requested information and does not generate any recommendations."
      ]
    },
    {
      "heading": "2.. Random recommendation (B2)",
      "text": [
        "The system randomly chooses a recommendation",
        "from six methods.",
        "The comparison of the average reward between the baseline methods is listed in Table 1.",
        "Note that the oracle average reward that can be obtained only when the user knows all knowledge about the knowledge base (it requires at least 50 turns) was 1.45.",
        "The reward by the strategy optimized by NAC was significantly better than that of baseline methods (n = 500,p < .01).",
        "We then compared the proposed method with the case where estimated user's knowledge and preference are represented as discrete binary parameters instead of probability distributions (PDs).",
        "That is, the estimated user's preference pm of determinant m is set to \"1\" when the user requested the determinant, otherwise it is \"0\".",
        "The estimated user's knowledge km is set to",
        "the following subsections.",
        "In our trial system, the dialogue length was 16.3 turns with a standard deviation of7.0 turns.",
        "\"1\" when the system lets the user know the determinant, otherwise it is \"0\".",
        "Another dialogue strategy was trained using this dialogue state expression.",
        "This result is shown in Table 2.",
        "The proposed method that represents the dialogue state as a probability distribution outperformed (p<.01 (T=15,20)) the method using a discrete state expression.",
        "We also compared the proposed method with the case where either one of estimated preference or knowledge was used as a feature for dialogue state in order to carefully investigate the effect of these factors.",
        "In the proposed method, expectation of the probability that the user emphasizes the determinant (Pr( kn = 1) x Pr(pn = 1)) was used as a feature of dialogue state.",
        "We evaluated the performance of the cases where the estimated knowledge Pr(kn = 1) or estimated preference Pr(pn = 1) was used instead of the expectation of the probability that the user emphasizes the determinant.",
        "We also compared with the case where no preference/knowledge feature was used.",
        "This result is shown in Table 3.",
        "We confirmed that significant improvement (p<.01 (T=15,20)) was obtained by taking into account the estimated knowledge of the user."
      ]
    },
    {
      "heading": "5. Conclusion",
      "text": [
        "In this paper, we presented a spoken dialogue framework that helps users select an alternative from a list of alternatives.",
        "We proposed a model of dialogue state for spoken decision making dialogue that considers knowledge as well as preference of the user and the system, and its dialogue strategy was trained by RL.",
        "We confirmed that the learned policy achieved a better recommendation strategy over several baseline methods.",
        "Although we dealt with a simple recommendation strategy with a fixed number of recommendation components, there are many possible extensions to this model.",
        "The system is expected to handle a more complex planning of natural language generation.",
        "We also need to consider errors in speech recognition and understanding when simulating dialogue."
      ]
    }
  ]
}
