{
  "info": {
    "authors": [
      "Yves Schabes",
      "Michael Roth",
      "Randy Osborne"
    ],
    "book": "Conference of the European Association for Computational Linguistics",
    "id": "acl-E93-1040",
    "title": "Parsing the Wall Street Journal With the Inside-Outside Algorithm",
    "url": "https://aclweb.org/anthology/E93-1040",
    "year": 1993
  },
  "references": [
    "acl-H90-1055",
    "acl-H91-1060",
    "acl-P92-1017",
    "acl-P92-1024"
  ],
  "sections": [
    {
      "heading": "Abstract",
      "text": [
        "We report grammar inference experiments on partially parsed sentences taken from the Wall Street Journal corpus using the inside-outside algorithm for stochastic context-free grammars.",
        "The initial grammar for the inference process makes no assumption of the kinds of structures and their distributions.",
        "The inferred grammar is evaluated by its predicting power and by comparing the bracketing of held out sentences imposed by the inferred grammar with the partial bracketings of these sentences given in the corpus.",
        "Using part-of-speech tags as the only source of lexical information, high bracketing accuracy is achieved even with a small subset of the available training material (1045 sentences): 94.4% for test sentences shorter than 10 words and 90.2% for sentences shorter than 15 words."
      ]
    },
    {
      "heading": "1 Introduction",
      "text": [
        "Most broad coverage natural language parsers have been designed by incorporating hand-crafted rules.",
        "These rules are also very often further refined by statistical training.",
        "Furthermore, it is widely believed that high performance can only be achieved by disambiguating lexically sensitive phenomena such as prepositional attachment ambiguity, coordination or subcategoriza-tion.",
        "So far, grammar inference has not been shown to be effective for designing wide coverage parsers.",
        "Baker (1979) describes a training algorithm for stochastic context-free grammars (SCFG) which can be used for grammar reestimation (Fujisaki et al.",
        "1989, Sharman et al.",
        "1990, Black et al.",
        "1992, Briscoe and Wae-gner 1992) or grammar inference from scratch (Lari and Young 1990).",
        "However, the application of SCFGs and the original inside-outside algorithm for grammar inference has been inconclusive for two reasons.",
        "First, each iteration of the algorithm on a grammar with n nonterminals requires 0( n31w13 ) time per training sentence w. Second, the inferred grammar imposes bracketings which do not agree with linguistic judgments of sentence structure.",
        "Pereira and Schabes (1992) extended the inside-outside algorithm for inferring the parameters of a stochastic context-free grammar to take advantage of constituent bracketing information in the training text.",
        "Although they report encouraging experiments (90% bracketing accuracy) on language transcriptions in the Texas Instrument subset of the Air Travel Information System (ATIS), the small size of the corpus (770 bracketed sentences containing a total of 7812 words), its linguistic simplicity, and the computation time required to train the grammar were reasons to believe that these results may not scale up to a larger and more diverse corpus.",
        "We report grammar inference experiments with this algorithm from the parsed Wall Street Journal corpus.",
        "The experiments prove the feasibility and effectiveness of the inside-outside algorithm on a large corpus.",
        "Such experiments are made possible by assuming a right branching structure whenever the parsed corpus leaves portions of the parsed tree unspecified.",
        "This preprocessing of the corpus makes it fully bracketed.",
        "By taking advantage of this fact in the implementation of the inside-outside algorithm, its complexity becomes linear with respect to the input length (as noted by Pereira and Schabes, 1992) and therefore tractable for large corpora.",
        "We report experiments using several kinds of initial grammars and a variety of subsets of the corpus as training data.",
        "When the entire Wall Street Journal corpus was used as training material, the time required for training has been further reduced by using a parallel implementation of the inside-outside algorithm.",
        "The inferred grammar is evaluated by measuring the percentage of compatible brackets of the bracketing imposed by the inferred grammar with the partial bracketing of held out sentences.",
        "Surprisingly high bracketing accuracy is achieved with only 1042 sentences as training material: 94.4% for test sentences shorter than 10 words and 90.2% for sentences shorter than 15 words.",
        "Furthermore, the bracketing accuracy does not drop drastically as longer sentences are considered.",
        "These results are surprising since the training uses part-of-speech tags as the only source of lexical information.",
        "This raises questions about the statistical distribution of sentence structures observed in naturally occurring text.",
        "After having described the training material used, we report experiments using several subsets of the available training material and evaluate the effect of the training size on the bracketing performance.",
        "Then, we describe a method for reducing the number of parameters in the inferred grammars.",
        "Finally, we suggest a stochastic model for inferring labels on the produced binary branching trees."
      ]
    },
    {
      "heading": "2 Training Corpus",
      "text": [
        "The experiments use texts from the Wall Street Journal Corpus and its partially bracketed version provided by the Penn Treebank (Brill et al., 1990).",
        "Out of 38 600 bracketed sentences (914 000 words), we extracted 34500 sentences (817 000 words) as possible source of training material and 4100 sentences (97 000 words) as source for testing.",
        "We experimented with several subsets (350, 1095, 8000 and 34500 sentences) of the available training material.",
        "For practical purposes, the part of the tree hank used for training is preprocessed before being used.",
        "First, flat portions of parse trees found in the tree bank are turned into a right linear binary branching structure.",
        "This enables us to take full advantage of the fact that the extended inside-outside algorithm (as described in Pereira and Schabes, 1992) behaves in linear time when the text is fully bracketed.",
        "Then, the syntactic labels are ignored.",
        "This allows the reestimation algorithm to distribute its own set of labels based on their actual distribution.",
        "We later suggest a method for recovering these labels.",
        "The following is an example of a partially parsed sentence found in the Penn Treebank:",
        "found in the training corpus.",
        "The experiments reported in this paper use only the part-of-speech sequences of this corpus and the resulting fully bracketed parses.",
        "For the above example, the following bracketing is used in the training material: (DT (NN (IN (DT (JJ NNS)))) (VBZ (VBN VBN)))"
      ]
    },
    {
      "heading": "3 Inferring Bracketings",
      "text": [
        "For the set of experiments described in this section, the initial grammar consists of all 4095 possible Chom",
        "sky Normal Form rules over 15 nonterminals (Xi, 1 < 1 < 15) and 48 terminal symbols (tin, 1 < m < 48) for part-of-speech tags (the same set as the one used in the Penn Treebank):",
        "The parameters of the initial stochastic context-free grammar are set randomly while maintaining the proper conditions for stochastic context-free grammars.1 Using the algorithm described in Pereira and Schabes (1992), the current rule probabilities and the parsed training set C are used to estimate the expected frequencies of each rule.",
        "Once these frequencies are computed over each bracketed sentence c in the training set, new rule probabilities are assigned in a way that increases the estimated probability of the bracketed training set.",
        "This process is iterated until the increase in the estimated probability of the bracketed training text becomes negligible, or equivalently, until the decrease in cross entropy (negative log probability)",
        "becomes negligible.",
        "In the above formula, the probability P(c) of the partially bracketed sentence c is computed as the sum of the probabilities of all derivations compatible with the bracketing of the sentence.",
        "This notion of compatible bracketing is defined in details in Pereira and Schabes (1992).",
        "Informally speaking, a derivation is compatible with the bracketing of the input given in the tree bank, if no bracket imposed by the derivation crosses a bracket in the input.",
        "Compatible bracket Input bracketing Incompatible bracket Input bracketing As training material, we selected randomly out of the available training material 1042 sentences of length shorter than 15 words.",
        "For evaluation purposes, we also 1.",
        "The sum of the probabilities of the rules with same left hand side must be one.",
        "randomly selected 84 sentences of length shorter than 15 words among the test sentences.",
        "Figure 1 shows the cross entropy of the training after each iteration.",
        "It also shows for each iteration the cross entropies fi of 84 sentences randomly selected among the test sentences of length shorter than 15 words.",
        "The cross entropy decreases as more iterations are performed and no over training is observed..",
        "To evaluate the quality of the analyses yielded by the inferred grammars obtained after each iteration, we used a Viterbi-style parser to find the most likely analyses of sentences in several test samples, and compared them with the Treebank partial bracketings of the sentences of those samples.",
        "For each sample, we counted the percent",
        "age of brackets of the most likely analysis that are not \"crossing\" the partial bracketing of the same sentences found in the Treebank.",
        "This percentage is called the bracketing accuracy (see Pereira and Schabes, 1992 for the precise definition of this measure).",
        "We also computed the percentage of sentences in each sample in which no crossing bracket was found.",
        "This percentage is called the sentence accuracy.",
        "Figure 2 shows the bracketing and sentence accuracy for the same 84 test sentences.",
        "Table 1 shows the bracketing and sentence accuracy for test sentences within various length ranges.",
        "High bracketing accuracy is obtained even on relatively long sentences.",
        "However, as expected, the sentence accuracy decreases rapidly as the sentences get longer.",
        "Table 2 compares our results with the bracketing accuracy of analyses obtained by a systematic right linear branching structure for all words except for the final punctuation mark (which we attached high).2 We also evaluated the stochastic context-free grammar obtained by collecting each level of the trees found in the training tree bank (see Table 2).",
        "Right linear structures perform surprisingly well.",
        "Our results improve by 20 percentage points upon this base line performance.",
        "These results suggest that the distribution of sentence structure in naturally occurring text is simpler than one may have thought, especially since only part-of-speech tags were used.",
        "This may suggest 2.",
        "We thank Eric Brill and David Yarowsky for suggesting these experiments.",
        "the existence of clusters of trees in the training material.",
        "However, using the number of crossing brackets as a distance between trees, we have been unable to reveal the existence of clusters.",
        "The grammar obtained by collecting rules from the tree bank performs very poorly.",
        "One can conclude that the labels used in the tree bank do not have any statistical property.",
        "The task of inferring a stochastic grammar from a tree bank is not trivial and therefore requires statistical training.",
        "In the appendix we give examples of the most likely analyses output by the inferred grammar on several test sentences In Table 3, different subsets of the available training sentences of lengths up to 15 words long and the grammars were evaluated on the same set of test sentences of lengths shorter than 15 words.",
        "The size of the training set does not seem to affect the performance of the parser.",
        "However if one includes all available sentences (34700 sentences), for the same test set, the bracketing accuracy drops to 84% and the sentence accuracy to 40%.",
        "We have also experimented with the following initial grammar which defines a large number of rules (11(X40):",
        "In this grammar, each non-terminal symbol is uniquely associated with a terminal symbol.",
        "We observed over-training with this grammar and better statistical convergence was obtained, however the performance of the parser did not improve."
      ]
    },
    {
      "heading": "4 Reducing the Grammar Size and Smoothing Issues",
      "text": [
        "As grammars are being inferred at each iteration, the training algorithm was designed to guarantee that no parameter was set below some small threshold.",
        "This constraint is important for smoothing.",
        "It implies that no rule ever disappears at a reestimation step.",
        "However, once the final grammar is found, for practical purposes, one can reduce the number of parameters being used.",
        "For example, the size of the grammar can be reduced by eliminating the rules whose probabilities are below some threshold or by keeping for each non-terminal only the top rules rewriting it.",
        "However, one runs into the risk of not being able to parse sentences given as input.",
        "We used the following smoothing heuristics.",
        "Lexical rule smoothing.",
        "In the case no rule in the grammar introduces a terminal symbol found in the input string, we assigned a lexical rule (X i r.) with very low probability for all non-terminal symbols.",
        "This case will not happen if the training is representative of the lexical items.",
        "Syntactic rule smoothing.",
        "When the sentence is not recognized from the starting symbol, we considered all possible non-terminal symbols as starting symbols and considered as starting symbol the one that yields the most likely analysis.",
        "Although this procedure may not guarantee that all sentences will be recognized, we found it is very useful in practice.",
        "When none of the above procedures enable parsing of the sentence, we used the entire set of parameters of the inferred grammar (this was never the case on the test sentences we considered).",
        "For example, the grammar whose performance is depicted in Table 2 defines 4095 parameters.",
        "However, the same performance is achieved on these test sets by using only 450 rules (the top 20 binary branching rules",
        "lexical rules Xi tm for each non-terminal symbol),"
      ]
    },
    {
      "heading": "5. Implementation",
      "text": [
        "Pereira and Schabes (1992) note that the training algorithm behaves in linear time (with respect to the sentence length) when the training material consists of fully bracketed sentences.",
        "By taking advantage of this fact, the experiments using a small number of initial rules and a small subset of the available training materials do not require a lot of computation time and can be performed on a single workstation.",
        "However, the experiments using larger initial grammars or using more material require more computation.",
        "The training algorithm can be pamllelized by dividing the training corpus into fixed size blocks of sentences and by having multiple workstations processing each one of them independently.",
        "When all blocks have been computed, the counts are merged and the parameters are reestimated.",
        "For this purpose, we used PVM (Beguelin et al., 1991) as a mechanism for message passing across workstations."
      ]
    },
    {
      "heading": "6. Stochastic Model of Labeling for Binary Branching Trees",
      "text": [
        "The stochastic grammars inferred by the training procedures produce unlabeled parse trees.",
        "We are currently evaluating the following stochastic model for labeling a binary branching tree.",
        "In this approach, we make the simplifying assumption that the label of a node only depends on the labels of its children.",
        "Under this assumption, the probability of labeling a tree is the product of the probability of labeling each level in the tree.",
        "For example, the probability of the following labeling:",
        "These probabilities can be estimated in a simple manner given a tree bank.",
        "For example, the probability of labeling a level as NP DT NN is estimated as the number of occurrences (in the tree bank) of NP DT NN divided by the number of occurrences of X DT NN where X ranges over every label.",
        "Then the probability of a labeling can be computed bottom-up from leaves to root.",
        "Using dynamic programming on increasingly large subtrees, the labeling with the highest probability can be computed.",
        "We are currently evaluating the effectiveness of this method."
      ]
    },
    {
      "heading": "7. Conclusion",
      "text": [
        "The experiments described in this paper prove the effectiveness of the inside-outside algorithm on a large corpus, and also shed some light on the distribution of sentence structures found in natural languages.",
        "We reported grammar inference experiments using the inside-outside algorithm on the parsed Wall Street Journal corpus.",
        "The experiments were made possible by turning the partially parsed training corpus into a fully bracketed corpus.",
        "Considering the fact that part-of-speech tags were the only source of lexical information actually used, surprisingly high bracketing accuracy is achieved (90.2% on sentences of length up to 15).",
        "We believe that even higher results can be achieved by using a richer set of part-of-speech tags.",
        "These results show that the use of simple distributions of constituency structures can provide high accuracy performance for broad coverage natural language parsers."
      ]
    },
    {
      "heading": "Acknowledgments",
      "text": [
        "We thank Eric Brill, Aravind Joshi, Mark Liberman, Mitchel Marcus, Fernando Pereira, Stuart Shieber and David Yarowsky for valuable discussions."
      ]
    },
    {
      "heading": "References",
      "text": []
    },
    {
      "heading": "Appendix Examples of parses",
      "text": [
        "The following parsed sentences are the most likely analyses output by the grammar inferred from 1042 training sentences (at iteration 68) for some randomly selected sentences of length not exceeding 10 words.",
        "Each parse is preceded by the bracketing given in the Treebank.",
        "Sentences output by the parser are printed in bold face and crossing brackets are marked with an asterisk (*)."
      ]
    }
  ]
}
